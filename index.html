<!doctype html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
</head>
<body>
<h1 class="heading">Hello There</h1>
<p class="paragraph">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Mattis molestie a iaculis at. Id aliquet lectus proin nibh. Sem et tortor consequat id porta</p>
<button class="button">Lorem ipsum</button>
</body>
<script>
var fonts = [
    'Roboto',
    'Open Sans',
    'Montserrat',
    'Lato',
    'Raleway',
    'Oswald',
    'Source Sans Pro',
    'Ubuntu',
    'Roboto Condensed',
    'PT Sans',
    'Nunito',
    'Merriweather',
    'PT Serif',
    'Droid Sans',
    'Droid Serif',
    'Lora',
    'Roboto Slab',
    'Playfair Display',
    'Fira Sans',
    'Bitter',
    'Crimson Text',
    'Indie Flower',
    'Lobster',
    'Pacifico'
];
var decfonts = []
for (i=0; i<3; i++) {
rand = Math.floor(Math.random() * fonts.length)
WebFont.load({
	google: {
		families: [fonts[rand]]
	}
});
decfonts.push(fonts[rand])
}
console.log(decfonts)
for (i=0; i<document.getElementsByClassName('heading').length; i++) {
document.getElementsByClassName('heading')[i].style.fontFamily = decfonts[0]
}
for (i=0; i<document.getElementsByClassName('paragraph').length; i++) {
document.getElementsByClassName('paragraph')[i].style.fontFamily = decfonts[1]
}
for (i=0; i<document.getElementsByClassName('button').length; i++) {
document.getElementsByClassName('button')[i].style.fontFamily = decfonts[2]
}
const numItemsToGenerate = 1; //how many gallery items you want on the screen
const imageWidth = window.innerWidth; //your desired image width in pixels
const imageHeight = window.innerHeight; //desired image height in pixels
const collectionID = 789878; //the collection ID from the original url
var image1 = new Image();
image1.crossOrigin = "anonymous";
var layout1 = new Image();

function renderGalleryItem() {
  fetch(`https://source.unsplash.com/collection/${collectionID}/${imageWidth}x${imageHeight}/`).then((response) => {
    image1.src = response.url;
  });
}

for (let i = 0; i < numItemsToGenerate; i++) {
  renderGalleryItem();
}

layout1.src = "layout1.png";
var data1 = '';
var canvas = document.createElement('canvas');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
var c = canvas.getContext('2d');
document.body.appendChild(canvas);
console.log(window.innerWidth, window.innerHeight);
function getcoloratpoint(xvalue, yvalue) {
  var x = xvalue; // the x-coordinate of the pixel
  var y = yvalue; // the y-coordinate of the pixel
  var index = (y * canvas.width + x) * 4;
  var red = imgdata.data[index];
  var green = imgdata.data[index + 1];
  var blue = imgdata.data[index + 2];
  var alpha = imgdata.data[index + 3];
  return red + ", " + green + ", " + blue + ", " + alpha
	}
	var test = 0
	var imgdata = 0
	var testdata = 0
	var startpos = []
	var startpos1 = []
	var endpos = []
	var endpos1 = []
layout1.onload = function() {
image1.onload = function() {
  c.drawImage(image1, 0, 0);
	c.fillStyle = "rgba(0, 0, 0, 0.1)"
	c.fillRect(0, 0, canvas.width, canvas.height)
  imgdata = c.getImageData(0, 0, canvas.width, canvas.height);

  // Get the color of the pixel at the given x and y location
  c.drawImage(layout1, 0, 0);
  var data1 = c.getImageData(0, 0, canvas.width, canvas.height);
var targetColor = [204, 204, 204, 255];
for (var i = 0; i < data1.data.length; i += 4) {
  var red = data1.data[i];
  var green = data1.data[i + 1];
  var blue = data1.data[i + 2];
  var alpha = data1.data[i + 3];
  if (red === targetColor[0] &&
      green === targetColor[1] &&
      blue === targetColor[2] &&
      alpha === targetColor[3]) {
     var x = (i / 4) % canvas.width;
var y = Math.floor((i / 4) / canvas.width);
    data1.data[i] = getcoloratpoint(x, y).split(", ")[0];
	  data1.data[i+1] = getcoloratpoint(x, y).split(", ")[1];
	  data1.data[i+2] = getcoloratpoint(x, y).split(", ")[2];
	  data1.data[i+3] = getcoloratpoint(x, y).split(", ")[3];
	  testdata = data1
  }
}
var targetColor = [255, 255, 255, 255];
	test = 0
	setwhite = 0
for (var i = 0; i < data1.data.length; i += 4) {
  var red = data1.data[i];
  var green = data1.data[i + 1];
  var blue = data1.data[i + 2];
  var alpha = data1.data[i + 3];
  if (red === targetColor[0] &&
      green === targetColor[1] &&
      blue === targetColor[2] &&
      alpha === targetColor[3]) {
	  test += 1
     var x = (i / 4) % canvas.width;
var y = Math.floor((i / 4) / canvas.width);
	  if (test == 1) {
		  startpos = [x, y]
	  }
	  if (test == 85636) {
		  endpos = [x, y]
	  }
	  if (test == 85637) {
		  startpos1 = [x, y]
	  }
	  if (test == 138286) {
		  endpos1 = [x, y]
	  }
    data1.data[i] = getcoloratpoint(x, y).split(", ")[0];
	  data1.data[i+1] = getcoloratpoint(x, y).split(", ")[1];
	  data1.data[i+2] = getcoloratpoint(x, y).split(", ")[2];
	  data1.data[i+3] = getcoloratpoint(x, y).split(", ")[3];
	  testdata = data1
  }
}
c.putImageData(data1, 0, 0);
	c.fillStyle = "rgba(255, 255, 255, 0.7)"
	c.fillRect(startpos[0], startpos[1], endpos[0] - startpos[0] + 3, endpos[1] - startpos[1] + 3)
	c.fillRect(startpos1[0], startpos1[1], endpos1[0] - startpos1[0] + 3, endpos1[1] - startpos1[1] + 3)
	c.fillStyle = "black"
	width = endpos[0] - startpos[0]
	c.font = "12px " + decfonts[1];
	placetext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Mattis molestie a iaculis at. Id aliquet lectus proin nibh. Sem et tortor consequat id porta."
	textwrapnum = Math.ceil(c.measureText(placetext).width / width)
	listtext = placetext.split(" ")
	console.log(textwrapnum)
	console.log(listtext)
	textlistarr = []
	console.log(decfonts[1])
	for (a=0; a<textwrapnum; a++) {
		console.log(a)
		textlistarr.push(listtext.slice(Math.ceil(listtext.length/textwrapnum)*a, Math.ceil(listtext.length/textwrapnum)*(a+1)))
		val = textlistarr[a]
		console.log('no error')
		if (c.measureText(val).width > width) {
			val.pop()
		}
		val = val.join(" ")
		c.fillText(val, 5 + startpos[0], 15 + startpos[1] + a*17)
	}
	console.log(textlistarr)
}
};
</script>
</html>
